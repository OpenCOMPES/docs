
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Calibrator &#8212; SED 1.0.1.dev34+g840a8d9 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=f4fa6047"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'sed/calibrator';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/OpenCOMPES/docs/main/sed/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.0.1.dev34+g840a8d9';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            true;
        </script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dataset" href="dataset.html" />
    <link rel="prev" title="Binning" href="binning.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.0.1.dev34+g840a8d9" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">SED 1.0.1.dev34+g840a8d9 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../workflows/index.html">
    Workflows
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../misc/contribution.html">
    Development
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/OpenCOMPES/sed" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
          
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../workflows/index.html">
    Workflows
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../misc/contribution.html">
    Development
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/OpenCOMPES/sed" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="core.html">Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="dfops.html">Dataframe Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="loader.html">Data loader</a></li>
<li class="toctree-l1"><a class="reference internal" href="binning.html">Binning</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Calibrator</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="diagnostic.html">Diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">IO</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Config</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item"><nav class="sidebar-indices-items" aria-labelledby="pst-indices-navigation-heading-2">
  <p id="pst-indices-navigation-heading-2" class="sidebar-indices-items__title" role="heading" aria-level="1">Indices</p>
  <ul class="indices-link">
        <li class="toctree-l1">
          <a class="reference internal"
             href="../genindex.html"
             accesskey="I">General Index</a>
        </li>
        <li class="toctree-l1">
          <a class="reference internal" href="../py-modindex.html">Python Module Index</a>
        </li>
  </ul>
</nav></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="api.html" class="nav-link">API</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Calibrator</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="calibrator">
<h1>Calibrator<a class="headerlink" href="#calibrator" title="Link to this heading">#</a></h1>
<section id="module-sed.calibrator.momentum">
<span id="momentum-calibration-and-correction"></span><h2>Momentum calibration and correction<a class="headerlink" href="#module-sed.calibrator.momentum" title="Link to this heading">#</a></h2>
<p>sed.calibrator.momentum module. Code for momentum calibration and distortion
correction. Mostly ported from <a class="github reference external" href="https://github.com/mpes-kit/mpes">mpes-kit/mpes</a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sed.calibrator.momentum.</span></span><span class="sig-name descname"><span class="pre">MomentumCorrector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Momentum distortion correction and momentum calibration workflow functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xr.DataArray</em><em> | </em><em>np.ndarray</em><em>, </em><em>optional</em>) – Multidimensional hypervolume
containing the data. Defaults to None.</p></li>
<li><p><strong>bin_ranges</strong> (<em>list</em><em>[</em><em>tuple</em><em>]</em><em>, </em><em>optional</em>) – Binning ranges of the data volume, if
provided as np.ndarray. Defaults to None.</p></li>
<li><p><strong>rotsym</strong> (<em>int</em><em>, </em><em>optional</em>) – Rotational symmetry of the data. Defaults to 6.</p></li>
<li><p><strong>config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Config dictionary. Defaults to None.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to print out diagnostic information.
Defaults to True.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.verbose">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">verbose</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.verbose" title="Link to this definition">#</a></dt>
<dd><p>Accessor to the verbosity flag.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Verbosity flag.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.features">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.features" title="Link to this definition">#</a></dt>
<dd><p>Dictionary of detected features for the symmetrization process.
<code class="docutils literal notranslate"><span class="pre">self.features</span></code> is a derived attribute from existing ones.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict containing features “verts” and “center”.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.symscores">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">symscores</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.symscores" title="Link to this definition">#</a></dt>
<dd><p>Dictionary of symmetry-related scores.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing symmetry scores.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.load_data" title="Link to this definition">#</a></dt>
<dd><p>Load binned data into the momentum calibrator class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xr.DataArray</em><em> | </em><em>np.ndarray</em>) – 2D or 3D data array, either as np.ndarray or xr.DataArray.</p></li>
<li><p><strong>bin_ranges</strong> (<em>list</em><em>[</em><em>tuple</em><em>]</em><em>, </em><em>optional</em>) – Binning ranges. Needs to be provided in case the data are given
as np.ndarray. Otherwise, they are determined from the coords of
the xr.DataArray. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if the dimensions of the input data do not fit.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.select_slicer">
<span class="sig-name descname"><span class="pre">select_slicer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plane</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.select_slicer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.select_slicer" title="Link to this definition">#</a></dt>
<dd><p>Interactive panel to select (hyper)slice from a (hyper)volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plane</strong> (<em>int</em><em>, </em><em>optional</em>) – initial value of the plane slider. Defaults to 0.</p></li>
<li><p><strong>width</strong> (<em>int</em><em>, </em><em>optional</em>) – initial value of the width slider. Defaults to 5.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>) – Axis along which to slice the image. Defaults to 2.</p></li>
<li><p><strong>apply</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to directly apply the values and select the
slice. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.select_slice">
<span class="sig-name descname"><span class="pre">select_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.select_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.select_slice" title="Link to this definition">#</a></dt>
<dd><p>Select (hyper)slice from a (hyper)volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selector</strong> (<em>slice</em><em> | </em><em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>int</em>) – Selector along the specified axis to extract the slice (image). Use
the construct slice(start, stop, step) to select a range of images
and sum them. Use an integer to specify only a particular slice.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>) – Axis along which to select the image. Defaults to 2.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if self.image is already 2D.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.add_features">
<span class="sig-name descname"><span class="pre">add_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ccw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symscores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rotation'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.add_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.add_features" title="Link to this definition">#</a></dt>
<dd><p>Add features as reference points provided as np.ndarray. If provided,
detects the center of the points and orders the points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> (<em>np.ndarray</em>) – Array of landmarks, possibly including a center peak. Its shape should
be (n,2), where n is equal to the rotation symmetry, or the rotation
symmetry+1, if the center is included.</p></li>
<li><p><strong>direction</strong> (<em>str</em><em>, </em><em>optional</em>) – Direction for ordering the points. Defaults to “ccw”.</p></li>
<li><p><strong>symscores</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to calculate symmetry scores. Defaults to False.</p></li>
<li><p><strong>symtype</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of symmetry scores to calculate
if symscores is True. Defaults to “rotation”.</p></li>
<li><p><strong>rotsym</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>, default: <code class="docutils literal notranslate"><span class="pre">6</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if the number of points does not match the rotsym.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.feature_extract">
<span class="sig-name descname"><span class="pre">feature_extract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ccw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'points'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symscores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.feature_extract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.feature_extract" title="Link to this definition">#</a></dt>
<dd><p>Extract features from the selected 2D slice.
Currently only point feature detection is implemented.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – The (2D) image slice to extract features from.
Defaults to self.slice</p></li>
<li><p><strong>direction</strong> (<em>str</em><em>, </em><em>optional</em>) – The circular direction to reorder the features in (‘cw’ or ‘ccw’).
Defaults to “ccw”.</p></li>
<li><p><strong>feature_type</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of features to extract. Defaults to “points”.</p></li>
<li><p><strong>rotsym</strong> (<em>int</em><em>, </em><em>optional</em>) – Rotational symmetry of the data. Defaults to 6.</p></li>
<li><p><strong>symscores</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option for calculating symmetry scores. Defaults to True.</p></li>
<li><p><strong>**kwds</strong> – Extra keyword arguments for <code class="docutils literal notranslate"><span class="pre">symmetrize.pointops.peakdetect2d()</span></code> and
<code class="docutils literal notranslate"><span class="pre">add_features()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Raised for undefined feature_types.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.feature_select">
<span class="sig-name descname"><span class="pre">feature_select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotsym</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.feature_select"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.feature_select" title="Link to this definition">#</a></dt>
<dd><p>Extract features from the selected 2D slice.
Currently only point feature detection is implemented.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – The (2D) image slice to extract features from.
Defaults to self.slice</p></li>
<li><p><strong>include_center</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to include the image center/centroid in the registration
process. Defaults to True.</p></li>
<li><p><strong>features</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Array of landmarks, possibly including a center peak. Its shape should
be (n,2), where n is equal to the rotation symmetry, or the rotation
symmetry+1, if the center is included.
If omitted, an array filled with zeros is generated.</p></li>
<li><p><strong>rotsym</strong> (<em>int</em><em>, </em><em>optional</em>) – Rotational symmetry of the data. Defaults to 6.</p></li>
<li><p><strong>apply</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to directly store the features in the class.
Defaults to False.</p></li>
<li><p><strong>**kwds</strong> – Keyword arguments for <code class="docutils literal notranslate"><span class="pre">add_features</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If no valid image is found from which to ge the coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.calc_geometric_distances">
<span class="sig-name descname"><span class="pre">calc_geometric_distances</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.calc_geometric_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.calc_geometric_distances" title="Link to this definition">#</a></dt>
<dd><p>Calculate geometric distances involving the center and the vertices.
Distances calculated include center-vertex and nearest-neighbor vertex-vertex
distances.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.calc_symmetry_scores">
<span class="sig-name descname"><span class="pre">calc_symmetry_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rotation'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.calc_symmetry_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.calc_symmetry_scores" title="Link to this definition">#</a></dt>
<dd><p>Calculate the symmetry scores from geometric quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>symtype</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of symmetry score to calculate.
Defaults to “rotation”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Calculated symmetry score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.spline_warp_estimate">
<span class="sig-name descname"><span class="pre">spline_warp_estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.spline_warp_estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.spline_warp_estimate" title="Link to this definition">#</a></dt>
<dd><p>Estimate the spline deformation field using thin plate spline registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – 2D array. Image slice to be corrected. Defaults to self.slice.</p></li>
<li><p><strong>use_center</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to use the image center/centroid in the registration
process. Defaults to config value, or True.</p></li>
<li><p><strong>fixed_center</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to have a fixed center during registration-based
symmetrization. Defaults to True.</p></li>
<li><p><strong>interp_order</strong> (<em>int</em><em>, </em><em>optional</em>) – Order of interpolation (see <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.map_coordinates()</span></code>).
Defaults to 1.</p></li>
<li><p><strong>ascale</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</span>, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – (float | list | tuple | np.ndarray, optional): Scale parameter determining a
relative scale for each symmetry feature. If provided as single float, rotsym has
to be 4. This parameter describes the relative scaling between the two orthogonal
symmetry directions (for an orthorhombic system). This requires the correction
points to be located along the principal axes (X/Y points of the Brillouin zone).
Otherwise, an array with <code class="docutils literal notranslate"><span class="pre">rotsym</span></code> elements is expected, containing relative
scales for each feature. Defaults to an array of equal scales.</p></li>
<li><p><strong>**kwds</strong> – <p>keyword arguments:</p>
<ul>
<li><p><strong>landmarks</strong>: (list/array): Landmark positions (row, column) used
for registration. Defaults to  self.pouter_ord</p></li>
<li><p><strong>targets</strong>: (list/array): Target positions (row, column) used for
registration. If empty, it will be generated by
<code class="docutils literal notranslate"><span class="pre">symmetrize.rotVertexGenerator()</span></code>.</p></li>
<li><p><strong>new_centers</strong>: (dict): User-specified center positions for the
reference and target sets. {‘lmkcenter’: (row, col),
‘targcenter’: (row, col)}</p></li>
</ul>
<p>Additional keywords are passed to <code class="docutils literal notranslate"><span class="pre">tpsWarping()</span></code>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The corrected image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.apply_correction">
<span class="sig-name descname"><span class="pre">apply_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dfield</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.apply_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.apply_correction" title="Link to this definition">#</a></dt>
<dd><p>Apply a 2D transform to a stack of 2D images (3D) along a specific axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.ndarray</em>) – Image which to apply the transformation to</p></li>
<li><p><strong>axis</strong> (<em>int</em>) – Axis for slice selection.</p></li>
<li><p><strong>dfield</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – row and column deformation field.
Defaults to [self.rdeform_field, self.cdeformfield].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The corrected image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.reset_deformation">
<span class="sig-name descname"><span class="pre">reset_deformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.reset_deformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.reset_deformation" title="Link to this definition">#</a></dt>
<dd><p>Reset the deformation field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwds</strong> – <p>keyword arguments:</p>
<ul class="simple">
<li><p><strong>image</strong>: the image to base the deformation fields on. Its sizes are
used. Defaults to self.slice</p></li>
<li><p><strong>coordtype</strong>: The coordinate system to use. Defaults to ‘cartesian’.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.update_deformation">
<span class="sig-name descname"><span class="pre">update_deformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdeform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdeform</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.update_deformation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.update_deformation" title="Link to this definition">#</a></dt>
<dd><p>Update the class deformation field by applying the provided column/row
deformation fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdeform</strong> (<em>np.ndarray</em>) – 2D array of row-ordered deformation field.</p></li>
<li><p><strong>cdeform</strong> (<em>np.ndarray</em>) – 2D array of column-ordered deformation field.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.coordinate_transform">
<span class="sig-name descname"><span class="pre">coordinate_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapkwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.coordinate_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.coordinate_transform" title="Link to this definition">#</a></dt>
<dd><p>Apply a pixel-wise coordinate transform to the image
by means of the deformation field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transform_type</strong> (<em>str</em>) – <p>Type of deformation to apply to image slice. Possible
values are:</p>
<ul>
<li><p>translation.</p></li>
<li><p>rotation.</p></li>
<li><p>rotation_auto.</p></li>
<li><p>scaling.</p></li>
<li><p>scaling_auto.</p></li>
<li><p>homography.</p></li>
</ul>
</p></li>
<li><p><strong>keep</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to keep the specified coordinate transform in
the class. Defaults to False.</p></li>
<li><p><strong>interp_order</strong> (<em>int</em><em>, </em><em>optional</em>) – Interpolation order for filling in missed
pixels. Defaults to 1.</p></li>
<li><p><strong>mapkwds</strong> (<em>dict</em><em>, </em><em>optional</em>) – Additional arguments passed to
<code class="docutils literal notranslate"><span class="pre">scipy.ndimage.map_coordinates()</span></code>. Defaults to None.</p></li>
<li><p><strong>**kwds</strong> – <p>keyword arguments.</p>
<ul>
<li><p><strong>image</strong>: Image to use. Defaults to self.slice.</p></li>
<li><p><strong>stackaxis</strong>: Stacking axis for coordinate transformation matrices.
Defaults to 0.</p></li>
</ul>
<p>Additional arguments are passed to the specific deformation field generators.
See <code class="docutils literal notranslate"><span class="pre">symmetrize.sym</span></code> module.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The corrected image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.pose_adjustment">
<span class="sig-name descname"><span class="pre">pose_adjustment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transformations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.pose_adjustment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.pose_adjustment" title="Link to this definition">#</a></dt>
<dd><p>Interactive panel to adjust transformations that are applied to the image.
Applies first a scaling, next a x/y translation, and last a rotation around
the center of the image (pixel 256/256).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transformations</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary with transformations.
Defaults to self.transformations or config[“momentum”][“transformations”].</p></li>
<li><p><strong>apply</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to directly apply the provided transformations.
Defaults to False.</p></li>
<li><p><strong>reset</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to reset the correction before transformation. Defaults to True.</p></li>
<li><p><strong>**kwds</strong> – <p>Keyword parameters defining defaults for the transformations:</p>
<ul>
<li><p><strong>scale</strong> (float): Initial value of the scaling slider.</p></li>
<li><p><strong>xtrans</strong> (float): Initial value of the xtrans slider.</p></li>
<li><p><strong>ytrans</strong> (float): Initial value of the ytrans slider.</p></li>
<li><p><strong>angle</strong> (float): Initial value of the angle slider.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.calc_inverse_dfield">
<span class="sig-name descname"><span class="pre">calc_inverse_dfield</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.calc_inverse_dfield"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.calc_inverse_dfield" title="Link to this definition">#</a></dt>
<dd><p>Calculate the inverse dfield from the cdeform and rdeform fields</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.view">
<span class="sig-name descname"><span class="pre">view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lower'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'terrain_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(4,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'matplotlib'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imkwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatterkwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosshair</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosshair_radii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[50,</span> <span class="pre">100,</span> <span class="pre">150]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosshair_thickness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.view" title="Link to this definition">#</a></dt>
<dd><p>Display image slice with specified annotations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – The image to plot. Defaults to self.slice.</p></li>
<li><p><strong>origin</strong> (<em>Literal</em><em>[</em><em>&quot;upper&quot;</em><em>, </em><em>&quot;lower&quot;</em><em>]</em><em>, </em><em>optional</em>) – Figure origin specification
(‘lower’ or ‘upper’). Defaults to “lower”.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap specification. Defaults to “terrain_r”.</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Figure size. Defaults to (4, 4).</p></li>
<li><p><strong>points</strong> (<em>dict</em><em>, </em><em>optional</em>) – Points for annotation. Defaults to None.</p></li>
<li><p><strong>annotated</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to add annotation. Defaults to False.</p></li>
<li><p><strong>backend</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Visualization backend specification. Defaults to
“matplotlib”.</p>
<ul>
<li><p>’matplotlib’: use static display rendered by matplotlib.</p></li>
<li><p>’bokeh’: use interactive display rendered by bokeh.</p></li>
</ul>
</p></li>
<li><p><strong>imkwds</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for
<code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.imshow()</span></code>. Defaults to {}.</p></li>
<li><p><strong>scatterkwds</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for
<code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.scatter()</span></code>. Defaults to {}.</p></li>
<li><p><strong>cross</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to display a horizontal/vertical lines at
self.pcent. Defaults to False.</p></li>
<li><p><strong>crosshair</strong> (<em>bool</em><em>, </em><em>optional</em>) – Display option to plot circles around center
self.pcent. Works only in bokeh backend. Defaults to False.</p></li>
<li><p><strong>crosshair_radii</strong> (<em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Pixel radii of circles to plot when
crosshair option is activated. Defaults to [50, 100, 150].</p></li>
<li><p><strong>crosshair_thickness</strong> (<em>int</em><em>, </em><em>optional</em>) – Thickness of crosshair circles.
Defaults to 1.</p></li>
<li><p><strong>**kwds</strong> – keyword arguments.
General extra arguments for the plotting procedure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.select_k_range">
<span class="sig-name descname"><span class="pre">select_k_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point_a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_coord_a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_coord_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equiscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.select_k_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.select_k_range" title="Link to this definition">#</a></dt>
<dd><p>Interactive selection function for features for the Momentum axes calibration. It allows
the user to select the pixel positions of two symmetry points (a and b) and the k-space
distance of the two. Alternatively, the coordinates of both points can be provided. See the
equiscale option for details on the specifications of point coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point_a</strong> (<em>np.ndarray</em><em> | </em><em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Pixel coordinates of the
symmetry point a.</p></li>
<li><p><strong>point_b</strong> (<em>np.ndarray</em><em> | </em><em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Pixel coordinates of the
symmetry point b. Defaults to the center pixel of the image, defined by
config[“momentum”][“center_pixel”].</p></li>
<li><p><strong>k_distance</strong> (<em>float</em><em>, </em><em>optional</em>) – The known momentum space distance between the
two symmetry points.</p></li>
<li><p><strong>k_coord_a</strong> (<em>np.ndarray</em><em> | </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Momentum coordinate
of the symmetry points a. Only valid if equiscale=False.</p></li>
<li><p><strong>k_coord_b</strong> (<em>np.ndarray</em><em> | </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Momentum coordinate
of the symmetry points b. Only valid if equiscale=False. Defaults to
the k-space center np.array([0.0, 0.0]).</p></li>
<li><p><strong>equiscale</strong> (<em>bool</em><em>, </em><em>optional</em>) – <p>Option to adopt equal scale along both the x
and y directions.</p>
<ul>
<li><p><strong>True</strong>: Use a uniform scale for both x and y directions in the
image coordinate system. This applies to the situation where
k_distance is given and the points a and b are (close to) parallel
with one of the two image axes.</p></li>
<li><p><strong>False</strong>: Calculate the momentum scale for both x and y directions
separately. This applies to the situation where the points a and b
are sufficiently different in both x and y directions in the image
coordinate system.</p></li>
</ul>
<p>Defaults to ‘True’.</p>
</p></li>
<li><p><strong>apply</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to directly store the calibration parameters
to the class. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If no valid image is found from which to ge the coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.calibrate">
<span class="sig-name descname"><span class="pre">calibrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_coord_a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_coord_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equiscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.calibrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.calibrate" title="Link to this definition">#</a></dt>
<dd><p>Momentum axes calibration using the pixel positions of two symmetry points
(a and b) and the absolute coordinate of a single point (b), defaulted to
[0., 0.]. All coordinates should be specified in the (x/y), i.e. (column_index,
row_index) format. See the equiscale option for details on the specifications
of point coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point_a</strong> (<em>np.ndarray</em><em> | </em><em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Pixel coordinates of the
symmetry point a.</p></li>
<li><p><strong>point_b</strong> (<em>np.ndarray</em><em> | </em><em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Pixel coordinates of the
symmetry point b. Defaults to the center pixel of the image, defined by
config[“momentum”][“center_pixel”].</p></li>
<li><p><strong>k_distance</strong> (<em>float</em><em>, </em><em>optional</em>) – The known momentum space distance between the
two symmetry points.</p></li>
<li><p><strong>k_coord_a</strong> (<em>np.ndarray</em><em> | </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Momentum coordinate
of the symmetry points a. Only valid if equiscale=False.</p></li>
<li><p><strong>k_coord_b</strong> (<em>np.ndarray</em><em> | </em><em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Momentum coordinate
of the symmetry points b. Only valid if equiscale=False. Defaults to
the k-space center np.array([0.0, 0.0]).</p></li>
<li><p><strong>equiscale</strong> (<em>bool</em><em>, </em><em>optional</em>) – <p>Option to adopt equal scale along both the x
and y directions.</p>
<ul>
<li><p><strong>True</strong>: Use a uniform scale for both x and y directions in the
image coordinate system. This applies to the situation where
k_distance is given and the points a and b are (close to) parallel
with one of the two image axes.</p></li>
<li><p><strong>False</strong>: Calculate the momentum scale for both x and y directions
separately. This applies to the situation where the points a and b
are sufficiently different in both x and y directions in the image
coordinate system.</p></li>
</ul>
<p>Defaults to ‘True’.</p>
</p></li>
<li><p><strong>image</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – The energy slice for which to return the
calibration. Defaults to self.slice_corrected.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>dictionary with following entries:</p>
<blockquote>
<div><ul class="simple">
<li><p>”axes”: Tuple of 1D arrays
Momentum coordinates of the row and column.</p></li>
<li><p>”extent”: list
Extent of the two momentum axis (can be used directly in imshow).</p></li>
<li><p>”grid”: Tuple of 2D arrays
Row and column mesh grid generated from the coordinates
(can be used directly in pcolormesh).</p></li>
<li><p>”coeffs”: Tuple of (x, y) calibration coefficients</p></li>
<li><p>”x_center”, “y_center”: Pixel positions of the k-space center</p></li>
<li><p>”cstart”, “rstart”: Detector positions of the image used for
calibration</p></li>
<li><p>”cstep”, “rstep”: Step size of detector coordinates in the image
used for calibration</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.apply_corrections">
<span class="sig-name descname"><span class="pre">apply_corrections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_x_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_y_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.apply_corrections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.apply_corrections" title="Link to this definition">#</a></dt>
<dd><p>Calculate and replace the X and Y values with their distortion-corrected
version.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em> | </em><em>dask.dataframe.DataFrame</em>) – Dataframe to apply
the distortion correction to.</p></li>
<li><p><strong>x_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Label of the ‘X’ column before momentum
distortion correction. Defaults to config[“dataframe”][“columns”][“x”].</p></li>
<li><p><strong>y_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Label of the ‘Y’ column before momentum
distortion correction. Defaults to config[“dataframe”][“columns”][“y”].</p></li>
<li><p><strong>new_x_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Label of the ‘X’ column after momentum
distortion correction.
Defaults to config[“dataframe”][“columns”][“corrected_x”].</p></li>
<li><p><strong>new_y_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Label of the ‘Y’ column after momentum
distortion correction.
Defaults to config[“dataframe”][“columns”][“corrected_y”].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with
added columns and momentum correction metadata dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[pd.DataFrame | dask.dataframe.DataFrame, dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.gather_correction_metadata">
<span class="sig-name descname"><span class="pre">gather_correction_metadata</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.gather_correction_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.gather_correction_metadata" title="Link to this definition">#</a></dt>
<dd><p>Collect meta data for momentum correction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>generated correction metadata dictionary.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.append_k_axis">
<span class="sig-name descname"><span class="pre">append_k_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_x_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_y_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.append_k_axis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.append_k_axis" title="Link to this definition">#</a></dt>
<dd><p>Calculate and append the k axis coordinates (kx, ky) to the events dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em> | </em><em>dask.dataframe.DataFrame</em>) – Dataframe to apply the
distortion correction to.</p></li>
<li><p><strong>x_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Label of the source ‘X’ column.
Defaults to config[“dataframe”][“columns”][“corrected_x”] or
config[“dataframe”][“columns”][“x”] (whichever is present).</p></li>
<li><p><strong>y_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Label of the source ‘Y’ column.
Defaults to config[“dataframe”][“columns”][“corrected_y”] or
config[“dataframe”][“columns”][“y”] (whichever is present).</p></li>
<li><p><strong>new_x_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Label of the destination ‘X’ column after
momentum calibration. Defaults to config[“dataframe”][“columns”][“kx”].</p></li>
<li><p><strong>new_y_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Label of the destination ‘Y’ column after
momentum calibration. Defaults to config[“dataframe”][“columns”][“ky”].</p></li>
<li><p><strong>calibration</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary containing calibration parameters.
Defaults to ‘self.calibration’ or config[“momentum”][“calibration”].</p></li>
<li><p><strong>suppress_output</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to suppress output of diagnostic information.
Defaults to False.</p></li>
<li><p><strong>**kwds</strong> – Keyword parameters for momentum calibration. Parameters are added
to the calibration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with
added columns and momentum calibration metadata dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[pd.DataFrame | dask.dataframe.DataFrame, dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.momentum.MomentumCorrector.gather_calibration_metadata">
<span class="sig-name descname"><span class="pre">gather_calibration_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calibration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#MomentumCorrector.gather_calibration_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.MomentumCorrector.gather_calibration_metadata" title="Link to this definition">#</a></dt>
<dd><p>Collect meta data for momentum calibration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>calibration</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary with momentum calibration
parameters. If omitted will be taken from the class.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated metadata dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.momentum.cm2palette">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.momentum.</span></span><span class="sig-name descname"><span class="pre">cm2palette</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#cm2palette"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.cm2palette" title="Link to this definition">#</a></dt>
<dd><p>Convert certain matplotlib colormap (cm) to bokeh palette.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cmap_name</strong> (<em>str</em>) – Name of the colormap/palette.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of colors in hex representation (a bokeh palette).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.momentum.dictmerge">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.momentum.</span></span><span class="sig-name descname"><span class="pre">dictmerge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">main_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_entries</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#dictmerge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.dictmerge" title="Link to this definition">#</a></dt>
<dd><p>Merge a dictionary with other dictionaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>main_dict</strong> (<em>dict</em>) – Main dictionary.</p></li>
<li><p><strong>other_entries</strong> (<em>list</em><em>[</em><em>dict</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>dict</em><em>] </em><em>| </em><em>dict</em>) – Other dictionary or composite dictionarized elements.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Merged dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.momentum.detector_coordinates_2_k_coordinates">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.momentum.</span></span><span class="sig-name descname"><span class="pre">detector_coordinates_2_k_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_conversion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_conversion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#detector_coordinates_2_k_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.detector_coordinates_2_k_coordinates" title="Link to this definition">#</a></dt>
<dd><p>Conversion from detector coordinates (r_det, c_det) to momentum coordinates
(kr, kc).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_det</strong> (<em>float</em>) – Row detector coordinates.</p></li>
<li><p><strong>c_det</strong> (<em>float</em>) – Column detector coordinates.</p></li>
<li><p><strong>r_start</strong> (<em>float</em>) – Start value for row detector coordinates.</p></li>
<li><p><strong>c_start</strong> (<em>float</em>) – Start value for column detector coordinates.</p></li>
<li><p><strong>r_center</strong> (<em>float</em>) – Center value for row detector coordinates.</p></li>
<li><p><strong>c_center</strong> (<em>float</em>) – Center value for column detector coordinates.</p></li>
<li><p><strong>r_conversion</strong> (<em>float</em>) – Row conversion factor.</p></li>
<li><p><strong>c_conversion</strong> (<em>float</em>) – Column conversion factor.</p></li>
<li><p><strong>r_step</strong> (<em>float</em>) – Row stepping factor.</p></li>
<li><p><strong>c_step</strong> (<em>float</em>) – Column stepping factor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted momentum space row/column coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.momentum.apply_dfield">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.momentum.</span></span><span class="sig-name descname"><span class="pre">apply_dfield</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dfield</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_x_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_y_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_ranges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#apply_dfield"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.apply_dfield" title="Link to this definition">#</a></dt>
<dd><p>Application of the inverse displacement-field to the dataframe coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em> | </em><em>dask.dataframe.DataFrame</em>) – Dataframe to apply the
distortion correction to.</p></li>
<li><p><strong>dfield</strong> (<em>np.ndarray</em>) – The distortion correction field. 3D matrix,
with column and row distortion fields stacked along the first dimension.</p></li>
<li><p><strong>x_column</strong> (<em>str</em>) – Label of the ‘X’ source column.</p></li>
<li><p><strong>y_column</strong> (<em>str</em>) – Label of the ‘Y’ source column.</p></li>
<li><p><strong>new_x_column</strong> (<em>str</em>) – Label of the ‘X’ destination column.</p></li>
<li><p><strong>new_y_column</strong> (<em>str</em>) – Label of the ‘Y’ destination column.</p></li>
<li><p><strong>detector_ranges</strong> (<em>list</em><em>[</em><em>tuple</em><em>]</em>) – tuple of pixel ranges of the detector x/y
coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dataframe with added columns</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame | dask.dataframe.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.momentum.generate_inverse_dfield">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.momentum.</span></span><span class="sig-name descname"><span class="pre">generate_inverse_dfield</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdeform_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdeform_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_ranges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#generate_inverse_dfield"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.generate_inverse_dfield" title="Link to this definition">#</a></dt>
<dd><p>Generate inverse deformation field using interpolation with griddata.
Assuming the binning range of the input <code class="docutils literal notranslate"><span class="pre">rdeform_field</span></code> and <code class="docutils literal notranslate"><span class="pre">cdeform_field</span></code>
covers the whole detector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdeform_field</strong> (<em>np.ndarray</em>) – Row-wise deformation field.</p></li>
<li><p><strong>cdeform_field</strong> (<em>np.ndarray</em>) – Column-wise deformation field.</p></li>
<li><p><strong>bin_ranges</strong> (<em>list</em><em>[</em><em>tuple</em><em>]</em>) – Detector ranges of the binned coordinates.</p></li>
<li><p><strong>detector_ranges</strong> (<em>list</em><em>[</em><em>tuple</em><em>]</em>) – Ranges of detector coordinates to interpolate to.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated inverse deformation field (row/column)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.momentum.load_dfield">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.momentum.</span></span><span class="sig-name descname"><span class="pre">load_dfield</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/momentum.html#load_dfield"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.momentum.load_dfield" title="Link to this definition">#</a></dt>
<dd><p>Load inverse dfield from file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – Path to file containing the inverse dfield</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the loaded inverse row and column deformation fields</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-sed.calibrator.energy">
<span id="energy-calibration-and-correction"></span><h2>Energy calibration and correction<a class="headerlink" href="#module-sed.calibrator.energy" title="Link to this heading">#</a></h2>
<p>sed.calibrator.energy module. Code for energy calibration and
correction. Mostly ported from <a class="github reference external" href="https://github.com/mpes-kit/mpes">mpes-kit/mpes</a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sed.calibrator.energy.</span></span><span class="sig-name descname"><span class="pre">EnergyCalibrator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Electron binding energy calibration workflow.</p>
<p>For the initialization of the EnergyCalibrator class an instance of a
loader is required. The data can be loaded using the optional arguments,
or using the load_data method or bin_data method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loader</strong> (<a class="reference internal" href="loader.html#sed.loader.base.loader.BaseLoader" title="sed.loader.base.loader.BaseLoader"><em>BaseLoader</em></a>) – Instance of a loader, subclassed from BaseLoader.</p></li>
<li><p><strong>biases</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Bias voltages used. Defaults to None.</p></li>
<li><p><strong>traces</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – TOF-Data traces corresponding to the bias
values. Defaults to None.</p></li>
<li><p><strong>tof</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – TOF-values for the data traces.
Defaults to None.</p></li>
<li><p><strong>config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Config dictionary. Defaults to None.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to print out diagnostic information.
Defaults to True.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.verbose">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">verbose</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.verbose" title="Link to this definition">#</a></dt>
<dd><p>Accessor to the verbosity flag.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Verbosity flag.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.ntraces">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ntraces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.ntraces" title="Link to this definition">#</a></dt>
<dd><p>Property returning the number of traces.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of loaded/calculated traces.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.nranges">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nranges</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.nranges" title="Link to this definition">#</a></dt>
<dd><p>Property returning the number of specified feature ranges which Can be a
multiple of ntraces.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of specified feature ranges.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.dup">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dup</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.dup" title="Link to this definition">#</a></dt>
<dd><p>Property returning the duplication number, i.e. the number of feature
ranges per trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The duplication number.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">biases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.load_data" title="Link to this definition">#</a></dt>
<dd><p>Load data into the class. Not provided parameters will be overwritten by
empty arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>biases</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Bias voltages used. Defaults to None.</p></li>
<li><p><strong>traces</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – TOF-Data traces corresponding to the bias
values. Defaults to None.</p></li>
<li><p><strong>tof</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – TOF-values for the data traces.
Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.bin_data">
<span class="sig-name descname"><span class="pre">bin_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.bin_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.bin_data" title="Link to this definition">#</a></dt>
<dd><p>Bin data from single-event files, and load into class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_files</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – list of file names to bin</p></li>
<li><p><strong>axes</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – bin axes. Defaults to
config[“dataframe”][“columns”][“tof”].</p></li>
<li><p><strong>bins</strong> (<em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – number of bins.
Defaults to config[“energy”][“bins”].</p></li>
<li><p><strong>ranges</strong> (<em>Sequence</em><em>[</em><em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – bin ranges.
Defaults to config[“energy”][“ranges”].</p></li>
<li><p><strong>biases</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Bias voltages used.
If not provided, biases are extracted from the file meta data.</p></li>
<li><p><strong>bias_key</strong> (<em>str</em><em>, </em><em>optional</em>) – hdf5 path where bias values are stored.
Defaults to config[“energy”][“bias_key”].</p></li>
<li><p><strong>**kwds</strong> – Keyword parameters for bin_dataframe</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.normalize" title="Link to this definition">#</a></dt>
<dd><p>Normalize the spectra along an axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smooth</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to smooth the signals before normalization.
Defaults to False.</p></li>
<li><p><strong>span</strong> (<em>int</em><em>, </em><em>optional</em>) – span smoothing parameters of the LOESS method
(see <code class="docutils literal notranslate"><span class="pre">scipy.signal.savgol_filter()</span></code>). Defaults to 7.</p></li>
<li><p><strong>order</strong> (<em>int</em><em>, </em><em>optional</em>) – order smoothing parameters of the LOESS method
(see <code class="docutils literal notranslate"><span class="pre">scipy.signal.savgol_filter()</span></code>). Defaults to 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.adjust_ranges">
<span class="sig-name descname"><span class="pre">adjust_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.adjust_ranges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.adjust_ranges" title="Link to this definition">#</a></dt>
<dd><p>Display a tool to select or extract the equivalent feature ranges
(containing the peaks) among all traces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ranges</strong> (<em>tuple</em>) – Collection of feature detection ranges, within which an algorithm
(i.e. 1D peak detector) with look for the feature.</p></li>
<li><p><strong>ref_id</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of the reference trace. Defaults to 0.</p></li>
<li><p><strong>traces</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Collection of energy dispersion curves.
Defaults to self.traces_normed.</p></li>
<li><p><strong>peak_window</strong> (<em>int</em><em>, </em><em>optional</em>) – area around a peak to check for other peaks.
Defaults to 7.</p></li>
<li><p><strong>apply</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to directly apply the provided parameters.
Defaults to False.</p></li>
<li><p><strong>**kwds</strong> – keyword arguments
- <em>labels</em>: List of labels for plotting. Default uses the bias voltages.
- <em>figsize</em> Figure size.
Additional keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">find_correspondence()</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.add_ranges">
<span class="sig-name descname"><span class="pre">add_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_others</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'replace'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.add_ranges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.add_ranges" title="Link to this definition">#</a></dt>
<dd><p>Select or extract the equivalent feature ranges (containing the peaks) among all traces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ranges</strong> (<em>list</em><em>[</em><em>tuple</em><em>] </em><em>| </em><em>tuple</em>) – Collection of feature detection ranges, within which an algorithm
(i.e. 1D peak detector) with look for the feature.</p></li>
<li><p><strong>ref_id</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of the reference trace. Defaults to 0.</p></li>
<li><p><strong>traces</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Collection of energy dispersion curves.
Defaults to self.traces_normed.</p></li>
<li><p><strong>infer_others</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to infer the feature detection range
in other traces from a given one using a time warp algorithm.
Defaults to True.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Specification on how to change the feature ranges
(‘append’ or ‘replace’). Defaults to “replace”.</p></li>
<li><p><strong>**kwds</strong> – keyword arguments for trace alignment (see <code class="docutils literal notranslate"><span class="pre">find_correspondence()</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.feature_extract">
<span class="sig-name descname"><span class="pre">feature_extract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.feature_extract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.feature_extract" title="Link to this definition">#</a></dt>
<dd><p>Select or extract the equivalent landmarks (e.g. peaks) among all traces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ranges</strong> (<em>list</em><em>[</em><em>tuple</em><em>]</em><em>, </em><em>optional</em>) – List of ranges in each trace to look for
the peak feature, [start, end]. Defaults to self.featranges.</p></li>
<li><p><strong>traces</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Collection of 1D spectra to use for
calibration. Defaults to self.traces_normed.</p></li>
<li><p><strong>peak_window</strong> (<em>int</em><em>, </em><em>optional</em>) – area around a peak to check for other peaks.
Defaults to 7.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.calibrate">
<span class="sig-name descname"><span class="pre">calibrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lmfit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kinetic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landmarks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.calibrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.calibrate" title="Link to this definition">#</a></dt>
<dd><p>Calculate the functional mapping between time-of-flight and the energy
scale using optimization methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_energy</strong> (<em>float</em>) – Binding/kinetic energy of the detected feature.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Method for determining the energy calibration.</p>
<ul>
<li><p><strong>’lmfit’</strong>: Energy calibration using lmfit and 1/t^2 form.</p></li>
<li><p><strong>’lstsq’</strong>, <strong>‘lsqr’</strong>: Energy calibration using polynomial form.</p></li>
</ul>
<p>Defaults to ‘lmfit’.</p>
</p></li>
<li><p><strong>energy_scale</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Direction of increasing energy scale.</p>
<ul>
<li><p><strong>’kinetic’</strong>: increasing energy with decreasing TOF.</p></li>
<li><p><strong>’binding’</strong>: increasing energy with increasing TOF.</p></li>
</ul>
<p>Defaults to “kinetic”.</p>
</p></li>
<li><p><strong>landmarks</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Extracted peak positions (TOF) used for
calibration. Defaults to self.peaks.</p></li>
<li><p><strong>biases</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Bias values. Defaults to self.biases.</p></li>
<li><p><strong>t</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – TOF values. Defaults to self.tof.</p></li>
<li><p><strong>**kwds</strong> – keyword arguments.
See available keywords for <code class="docutils literal notranslate"><span class="pre">poly_energy_calibration()</span></code> and
<code class="docutils literal notranslate"><span class="pre">fit_energy_calibration()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if invalid ‘energy_scale’ is passed.</p></li>
<li><p><strong>NotImplementedError</strong> – Raised if invalid ‘method’ is passed.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Calibration dictionary with coefficients.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.view">
<span class="sig-name descname"><span class="pre">view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">segs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peaks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'matplotlib'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linekwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linesegkwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatterkwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legkwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.view" title="Link to this definition">#</a></dt>
<dd><p>Display a plot showing line traces with annotation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traces</strong> (<em>np.ndarray</em>) – Matrix of traces to visualize.</p></li>
<li><p><strong>segs</strong> (<em>list</em><em>[</em><em>tuple</em><em>]</em><em>, </em><em>optional</em>) – Segments to be highlighted in the
visualization. Defaults to None.</p></li>
<li><p><strong>peaks</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Peak positions for labelling the traces.
Defaults to None.</p></li>
<li><p><strong>show_legend</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to display bias voltages as legends.
Defaults to True.</p></li>
<li><p><strong>backend</strong> (<em>str</em><em>, </em><em>optional</em>) – Backend specification, choose between ‘matplotlib’
(static) or ‘bokeh’ (interactive). Defaults to “matplotlib”.</p></li>
<li><p><strong>linekwds</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for line plotting
(see <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.plot()</span></code>). Defaults to {}.</p></li>
<li><p><strong>linesegkwds</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for line segments plotting
(see <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.plot()</span></code>). Defaults to {}.</p></li>
<li><p><strong>scatterkwds</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for scatter plot
(see <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.scatter()</span></code>). Defaults to {}.</p></li>
<li><p><strong>legkwds</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for legend
(see <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.legend()</span></code>). Defaults to {}.</p></li>
<li><p><strong>**kwds</strong> – <p>keyword arguments:</p>
<ul>
<li><p><strong>labels</strong> (list): Labels for each curve</p></li>
<li><p><strong>xaxis</strong> (np.ndarray): x (horizontal) axis values</p></li>
<li><p><strong>title</strong> (str): Title of the plot</p></li>
<li><p><strong>legend_location</strong> (str): Location of the plot legend</p></li>
<li><p><strong>align</strong> (bool): Option to shift traces by bias voltage</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.append_energy_axis">
<span class="sig-name descname"><span class="pre">append_energy_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tof_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_voltage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.append_energy_axis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.append_energy_axis" title="Link to this definition">#</a></dt>
<dd><p>Calculate and append the energy axis to the events dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em> | </em><em>dask.dataframe.DataFrame</em>) – Dataframe to apply the energy axis calibration to.</p></li>
<li><p><strong>tof_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Label of the source column.
Defaults to config[“dataframe”][“columns”][“tof”].</p></li>
<li><p><strong>energy_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Label of the destination column.
Defaults to config[“dataframe”][“columns”][“energy”].</p></li>
<li><p><strong>calibration</strong> (<em>dict</em><em>, </em><em>optional</em>) – Calibration dictionary. If provided,
overrides calibration from class or config.
Defaults to self.calibration or config[“energy”][“calibration”].</p></li>
<li><p><strong>bias_voltage</strong> (<em>float</em><em>, </em><em>optional</em>) – Sample bias voltage of the scan data. If omitted,
the bias voltage is being read from the dataframe. If it is not found there,
a warning is printed and the calibrated data might have an offset.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to suppress output of diagnostic information.
Defaults to False.</p></li>
<li><p><strong>**kwds</strong> – additional keyword arguments for the energy conversion. They are
added to the calibration dictionary.</p></li>
<li><p><strong>suppress_output</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if expected calibration parameters are missing.</p></li>
<li><p><strong>NotImplementedError</strong> – Raised if an invalid calib_type is found.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dataframe with added column
and energy calibration metadata dictionary.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[pd.DataFrame | dask.dataframe.DataFrame, dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.append_tof_ns_axis">
<span class="sig-name descname"><span class="pre">append_tof_ns_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tof_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tof_ns_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.append_tof_ns_axis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.append_tof_ns_axis" title="Link to this definition">#</a></dt>
<dd><p>Converts the time-of-flight time from steps to time in ns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em> | </em><em>dask.dataframe.DataFrame</em>) – Dataframe to convert.</p></li>
<li><p><strong>tof_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the column containing the
time-of-flight steps. Defaults to config[“dataframe”][“columns”][“tof”].</p></li>
<li><p><strong>tof_ns_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the column to store the
time-of-flight in nanoseconds. Defaults to config[“dataframe”][“columns”][“tof_ns”].</p></li>
<li><p><strong>binwidth</strong> (<em>float</em><em>, </em><em>optional</em>) – Time-of-flight binwidth in ns.
Defaults to config[“energy”][“tof_binwidth”].</p></li>
<li><p><strong>binning</strong> (<em>int</em><em>, </em><em>optional</em>) – Time-of-flight binning factor.
Defaults to config[“energy”][“tof_binning”].</p></li>
<li><p><strong>**kwds</strong> – <ul>
<li><p><strong>binwidth</strong>: Binwidth in ns.</p></li>
<li><p><strong>binning</strong>: Binning factor of the TOF column.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with the new columns
and Metadata dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[pd.DataFrame | dask.dataframe.DataFrame, dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.gather_calibration_metadata">
<span class="sig-name descname"><span class="pre">gather_calibration_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calibration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.gather_calibration_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.gather_calibration_metadata" title="Link to this definition">#</a></dt>
<dd><p>Collects metadata from the energy calibration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>calibration</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary with energy calibration
parameters. Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated metadata dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.adjust_energy_correction">
<span class="sig-name descname"><span class="pre">adjust_energy_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.adjust_energy_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.adjust_energy_correction" title="Link to this definition">#</a></dt>
<dd><p>Visualize the energy correction function on top of the TOF/X/Y graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>xr.DataArray</em>) – Image data cube (x, y, tof) of binned data to plot.</p></li>
<li><p><strong>correction_type</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Type of correction to apply to the TOF
axis. Valid values are:</p>
<ul>
<li><p>’spherical’</p></li>
<li><p>’Lorentzian’</p></li>
<li><p>’Gaussian’</p></li>
<li><p>’Lorentzian_asymmetric’</p></li>
</ul>
<p>Defaults to config[“energy”][“correction_type”].</p>
</p></li>
<li><p><strong>amplitude</strong> (<em>float</em><em>, </em><em>optional</em>) – Amplitude of the time-of-flight correction
term. Defaults to config[“energy”][“correction”][“correction_type”].</p></li>
<li><p><strong>center</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Center (x/y) coordinates for the
correction. Defaults to config[“energy”][“correction”][“center”].</p></li>
<li><p><strong>correction</strong> (<em>dict</em><em>, </em><em>optional</em>) – Correction dict. Defaults to the config values
and is updated from provided and adjusted parameters.</p></li>
<li><p><strong>apply</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to store the provided parameters within
the class. Defaults to False.</p></li>
<li><p><strong>**kwds</strong> – <p>Additional parameters to use for the adjustment plots:</p>
<ul>
<li><p><strong>x_column</strong> (str): Name of the x column.</p></li>
<li><p><strong>y_column</strong> (str): Name of the y column.</p></li>
<li><p><strong>tof_column</strong> (str): Name of the tog column to convert.</p></li>
<li><p><strong>x_width</strong> (int, int): x range to integrate around the center</p></li>
<li><p><strong>y_width</strong> (int, int): y range to integrate around the center</p></li>
<li><p><strong>tof_fermi</strong> (int): TOF value of the Fermi level</p></li>
<li><p><strong>tof_width</strong> (int, int): TOF range to plot around tof_fermi</p></li>
<li><p><strong>color_clip</strong> (int): highest value to plot in the color range</p></li>
</ul>
<p>Additional parameters for the correction functions:</p>
<ul>
<li><p><strong>d</strong> (float): Field-free drift distance.</p></li>
<li><p><strong>gamma</strong> (float): Linewidth value for correction using a 2D
Lorentz profile.</p></li>
<li><p><strong>sigma</strong> (float): Standard deviation for correction using a 2D
Gaussian profile.</p></li>
<li><p><strong>gamma2</strong> (float): Linewidth value for correction using an
asymmetric 2D Lorentz profile, X-direction.</p></li>
<li><p><strong>amplitude2</strong> (float): Amplitude value for correction using an
asymmetric 2D Lorentz profile, X-direction.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Raised for invalid correction_type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.apply_energy_correction">
<span class="sig-name descname"><span class="pre">apply_energy_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tof_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_tof_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.apply_energy_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.apply_energy_correction" title="Link to this definition">#</a></dt>
<dd><p>Apply correction to the time-of-flight (TOF) axis of single-event data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em> | </em><em>dask.dataframe.DataFrame</em>) – The dataframe where
to apply the energy correction to.</p></li>
<li><p><strong>tof_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the source column to convert.
Defaults to config[“dataframe”][“columns”][“tof”].</p></li>
<li><p><strong>new_tof_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the destination column to convert.
Defaults to config[“dataframe”][“columns”][“corrected_tof”].</p></li>
<li><p><strong>correction_type</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Type of correction to apply to the TOF
axis. Valid values are:</p>
<ul>
<li><p>’spherical’</p></li>
<li><p>’Lorentzian’</p></li>
<li><p>’Gaussian’</p></li>
<li><p>’Lorentzian_asymmetric’</p></li>
</ul>
<p>Defaults to config[“energy”][“correction_type”].</p>
</p></li>
<li><p><strong>amplitude</strong> (<em>float</em><em>, </em><em>optional</em>) – Amplitude of the time-of-flight correction
term. Defaults to config[“energy”][“correction”][“correction_type”].</p></li>
<li><p><strong>correction</strong> (<em>dict</em><em>, </em><em>optional</em>) – Correction dictionary containing parameters
for the correction. Defaults to self.correction or
config[“energy”][“correction”].</p></li>
<li><p><strong>suppress_output</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to suppress output of diagnostic information.
Defaults to False.</p></li>
<li><p><strong>**kwds</strong> – <p>Additional parameters to use for the correction:</p>
<ul>
<li><p><strong>x_column</strong> (str): Name of the x column.</p></li>
<li><p><strong>y_column</strong> (str): Name of the y column.</p></li>
<li><p><strong>d</strong> (float): Field-free drift distance.</p></li>
<li><p><strong>gamma</strong> (float): Linewidth value for correction using a 2D
Lorentz profile.</p></li>
<li><p><strong>sigma</strong> (float): Standard deviation for correction using a 2D
Gaussian profile.</p></li>
<li><p><strong>gamma2</strong> (float): Linewidth value for correction using an
asymmetric 2D Lorentz profile, X-direction.</p></li>
<li><p><strong>amplitude2</strong> (float): Amplitude value for correction using an
asymmetric 2D Lorentz profile, X-direction.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dataframe with added column
and Energy correction metadata dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[pd.DataFrame | dask.dataframe.DataFrame, dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.gather_correction_metadata">
<span class="sig-name descname"><span class="pre">gather_correction_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.gather_correction_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.gather_correction_metadata" title="Link to this definition">#</a></dt>
<dd><p>Collect meta data for energy correction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>correction</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary with energy correction parameters.
Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated metadata dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.align_dld_sectors">
<span class="sig-name descname"><span class="pre">align_dld_sectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tof_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sector_id_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sector_delays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.align_dld_sectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.align_dld_sectors" title="Link to this definition">#</a></dt>
<dd><p>Aligns the time-of-flight axis of the different sections of a detector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>dask.dataframe.DataFrame</em>) – Dataframe to use.</p></li>
<li><p><strong>tof_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the column containing the time-of-flight values.
Defaults to config[“dataframe”][“columns”][“tof”].</p></li>
<li><p><strong>sector_id_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the column containing the sector id values.
Defaults to config[“dataframe”][“columns”][“sector_id”].</p></li>
<li><p><strong>sector_delays</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Array containing the sector delays. Defaults to
config[“dataframe”][“sector_delays”].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with the new columns and Metadata
dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[dask.dataframe.DataFrame, dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.energy.EnergyCalibrator.add_offsets">
<span class="sig-name descname"><span class="pre">add_offsets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preserve_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reductions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#EnergyCalibrator.add_offsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.EnergyCalibrator.add_offsets" title="Link to this definition">#</a></dt>
<dd><p>Apply an offset to the energy column by the values of the provided columns.</p>
<p>If no parameter is passed to this function, the offset is applied as defined in the
config file. If parameters are passed, they are used to generate a new offset dictionary
and the offset is applied using the <code class="docutils literal notranslate"><span class="pre">dfops.apply_offset_from_columns()</span></code> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em> | </em><em>dask.dataframe.DataFrame</em>) – Dataframe to use.</p></li>
<li><p><strong>offsets</strong> (<em>Dict</em><em>, </em><em>optional</em>) – Dictionary of energy offset parameters.</p></li>
<li><p><strong>constant</strong> (<em>float</em><em>, </em><em>optional</em>) – The constant to shift the energy axis by.</p></li>
<li><p><strong>columns</strong> (<em>str</em><em> | </em><em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Name of the column(s) to apply the shift from.</p></li>
<li><p><strong>weights</strong> (<em>float</em><em> | </em><em>Sequence</em><em>[</em><em>float</em><em>]</em>) – weights to apply to the columns.
Can also be used to flip the sign (e.g. -1). Defaults to 1.</p></li>
<li><p><strong>preserve_mean</strong> (<em>bool</em><em> | </em><em>Sequence</em><em>[</em><em>bool</em><em>]</em>) – Whether to subtract the mean of the column
before applying the shift. Defaults to False.</p></li>
<li><p><strong>reductions</strong> (<em>str</em><em> | </em><em>Sequence</em><em>[</em><em>str</em><em>]</em>) – The reduction to apply to the column. Should be an
available method of dask.dataframe.Series. For example “mean”. In this case the
function is applied to the column to generate a single value for the whole dataset.
If None, the shift is applied per-dataframe-row. Defaults to None. Currently only
“mean” is supported.</p></li>
<li><p><strong>energy_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the column containing the energy values.</p></li>
<li><p><strong>suppress_output</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to suppress output of diagnostic information.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with the new columns
and Metadata dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[pd.DataFrame | dask.dataframe.DataFrame, dict]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.energy.extract_bias">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.energy.</span></span><span class="sig-name descname"><span class="pre">extract_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#extract_bias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.extract_bias" title="Link to this definition">#</a></dt>
<dd><p>Read bias values from hdf5 files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>files</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of filenames</p></li>
<li><p><strong>bias_key</strong> (<em>str</em>) – hdf5 path to the bias value</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of bias values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.energy.correction_function">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.energy.</span></span><span class="sig-name descname"><span class="pre">correction_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#correction_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.correction_function" title="Link to this definition">#</a></dt>
<dd><p>Calculate the TOF correction based on the given X/Y coordinates and a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em><em> | </em><em>np.ndarray</em>) – x coordinate</p></li>
<li><p><strong>y</strong> (<em>float</em><em> | </em><em>np.ndarray</em>) – y coordinate</p></li>
<li><p><strong>correction_type</strong> (<em>str</em>) – type of correction. One of
“spherical”, “Lorentzian”, “Gaussian”, or “Lorentzian_asymmetric”</p></li>
<li><p><strong>center</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – center position of the distribution (x,y)</p></li>
<li><p><strong>amplitude</strong> (<em>float</em>) – Amplitude of the correction</p></li>
<li><p><strong>**kwds</strong> – <p>Keyword arguments:</p>
<ul>
<li><p><strong>diameter</strong> (float): Field-free drift distance.</p></li>
<li><p><strong>gamma</strong> (float): Linewidth value for correction using a 2D
Lorentz profile.</p></li>
<li><p><strong>sigma</strong> (float): Standard deviation for correction using a 2D
Gaussian profile.</p></li>
<li><p><strong>gamma2</strong> (float): Linewidth value for correction using an
asymmetric 2D Lorentz profile, X-direction.</p></li>
<li><p><strong>amplitude2</strong> (float): Amplitude value for correction using an
asymmetric 2D Lorentz profile, X-direction.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>calculated correction value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float | np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.energy.normspec">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.energy.</span></span><span class="sig-name descname"><span class="pre">normspec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#normspec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.normspec" title="Link to this definition">#</a></dt>
<dd><p>Normalize a series of 1D signals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>specs</strong> (<em>np.ndarray</em>) – Collection of 1D signals.</p></li>
<li><p><strong>smooth</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to smooth the signals before normalization.
Defaults to False.</p></li>
<li><p><strong>span</strong> (<em>int</em><em>, </em><em>optional</em>) – Smoothing span parameters of the LOESS method
(see <code class="docutils literal notranslate"><span class="pre">scipy.signal.savgol_filter()</span></code>). Defaults to 7.</p></li>
<li><p><strong>order</strong> (<em>int</em><em>, </em><em>optional</em>) – Smoothing order parameters of the LOESS method
(see <code class="docutils literal notranslate"><span class="pre">scipy.signal.savgol_filter()</span></code>).. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The matrix assembled from a list of maximum-normalized signals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.energy.find_correspondence">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.energy.</span></span><span class="sig-name descname"><span class="pre">find_correspondence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sig_still</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig_mov</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#find_correspondence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.find_correspondence" title="Link to this definition">#</a></dt>
<dd><p>Determine the correspondence between two 1D traces by alignment using a
time-warp algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sig_still</strong> (<em>np.ndarray</em>) – Reference 1D signals.</p></li>
<li><p><strong>sig_mov</strong> (<em>np.ndarray</em>) – 1D signal to be aligned.</p></li>
<li><p><strong>**kwds</strong> – keyword arguments for <code class="docutils literal notranslate"><span class="pre">fastdtw.fastdtw()</span></code>
- <em>dist_metric</em>: Distance metric to use for time warping. Defaults to None.
- <em>radius</em>: Radius to use for time warping. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pixel-wise path correspondences between two input 1D arrays
(sig_still, sig_mov).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.energy.range_convert">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.energy.</span></span><span class="sig-name descname"><span class="pre">range_convert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xrng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pathcorr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#range_convert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.range_convert" title="Link to this definition">#</a></dt>
<dd><p>Convert value range using a pairwise path correspondence (e.g. obtained
from time warping algorithm).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Values of the x axis (e.g. time-of-flight values).</p></li>
<li><p><strong>xrng</strong> (<em>tuple</em>) – Boundary value range on the x axis.</p></li>
<li><p><strong>pathcorr</strong> (<em>np.ndarray</em>) – Path correspondence between two 1D arrays in the
following form,
[(id_1_trace_1, id_1_trace_2), (id_2_trace_1, id_2_trace_2), …]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed range according to the path correspondence.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.energy.find_nearest">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.energy.</span></span><span class="sig-name descname"><span class="pre">find_nearest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">narray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#find_nearest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.find_nearest" title="Link to this definition">#</a></dt>
<dd><p>Find the value closest to a given one in a 1D array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> (<em>float</em>) – Value of interest.</p></li>
<li><p><strong>narray</strong> (<em>np.ndarray</em>) – The array to look for the nearest value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array index of the value nearest to the given one.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.energy.peaksearch">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.energy.</span></span><span class="sig-name descname"><span class="pre">peaksearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tof</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pkwindow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#peaksearch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.peaksearch" title="Link to this definition">#</a></dt>
<dd><p>Detect a list of peaks in the corresponding regions of multiple spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traces</strong> (<em>np.ndarray</em>) – Collection of 1D spectra.</p></li>
<li><p><strong>tof</strong> (<em>np.ndarray</em>) – Time-of-flight values.</p></li>
<li><p><strong>ranges</strong> (<em>list</em><em>[</em><em>tuple</em><em>]</em><em>, </em><em>optional</em>) – List of ranges for peak detection in the format</p></li>
<li><p><strong>[</strong> (<em>LowerBound1</em><em>, </em><em>UpperBound1</em><em>)</em><em>, </em><em>(</em><em>LowerBound2</em><em>, </em><em>UpperBound2</em>) – Defaults to None.</p></li>
<li><p><strong>pkwindow</strong> (<em>int</em><em>, </em><em>optional</em>) – Window width of a peak (amounts to lookahead in
<code class="docutils literal notranslate"><span class="pre">peakdetect1d</span></code>). Defaults to 3.</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Specify whether to display a custom plot of the peak
search results. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Collection of peak positions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.energy.peakdetect1d">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.energy.</span></span><span class="sig-name descname"><span class="pre">peakdetect1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lookahead</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#peakdetect1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.peakdetect1d" title="Link to this definition">#</a></dt>
<dd><p>Function for detecting local maxima and minima in a signal.
Discovers peaks by searching for values which are surrounded by lower
or larger values for maxima and minima respectively</p>
<p>Converted from/based on a MATLAB script at:
<a class="reference external" href="http://billauer.co.il/peakdet.html">http://billauer.co.il/peakdet.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_axis</strong> (<em>np.ndarray</em>) – A list containing the signal over which to find peaks.</p></li>
<li><p><strong>x_axis</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – A x-axis whose values correspond to the y_axis
list and is used in the return to specify the position of the peaks. If
omitted an index of the y_axis is used.</p></li>
<li><p><strong>lookahead</strong> (<em>int</em><em>, </em><em>optional</em>) – distance to look ahead from a peak candidate to
determine if it is the actual peak
‘(samples / period) / f’ where ‘4 &gt;= f &gt;= 1.25’ might be a good value.
Defaults to 200.</p></li>
<li><p><strong>delta</strong> (<em>int</em><em>, </em><em>optional</em>) – this specifies a minimum difference between a peak and
the following points, before a peak may be considered a peak. Useful
to hinder the function from picking up false peaks towards to end of
the signal. To work well delta should be set to delta &gt;= RMSnoise * 5.
Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if lookahead and delta are out of range.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of positions of the positive peaks,
positions of the negative peaks</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.energy.fit_energy_calibration">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.energy.</span></span><span class="sig-name descname"><span class="pre">fit_energy_calibration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binwidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binning</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kinetic'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#fit_energy_calibration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.fit_energy_calibration" title="Link to this definition">#</a></dt>
<dd><p>Energy calibration by nonlinear least squares fitting of spectral landmarks on
a set of (energy dispersion curves (EDCs). This is done here by fitting to the
function d/(t-t0)**2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>np.ndarray</em>) – Positions of the spectral landmarks
(e.g. peaks) in the EDCs.</p></li>
<li><p><strong>vals</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>np.ndarray</em>) – Bias voltage value associated with
each EDC.</p></li>
<li><p><strong>binwidth</strong> (<em>float</em>) – Time width of each original TOF bin in ns.</p></li>
<li><p><strong>binning</strong> (<em>int</em>) – Binning factor of the TOF values.</p></li>
<li><p><strong>ref_energy</strong> (<em>float</em>) – Energy value of the feature in the reference
trace (eV).</p></li>
<li><p><strong>t</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>np.ndarray</em><em>, </em><em>optional</em>) – Array of TOF values. Required
to calculate calibration trace. Defaults to None.</p></li>
<li><p><strong>energy_scale</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Direction of increasing energy scale.</p>
<ul>
<li><p><strong>’kinetic’</strong>: increasing energy with decreasing TOF.</p></li>
<li><p><strong>’binding’</strong>: increasing energy with increasing TOF.</p></li>
</ul>
</p></li>
<li><p><strong>**kwds</strong> – <p>keyword arguments:</p>
<ul>
<li><p><strong>t0</strong> (float): constrains and initial values for the fit parameter t0,
corresponding to the time of flight offset. Defaults to 1e-6.</p></li>
<li><p><strong>E0</strong> (float): constrains and initial values for the fit parameter E0,
corresponding to the energy offset. Defaults to min(vals).</p></li>
<li><p><strong>d</strong> (float): constrains and initial values for the fit parameter d,
corresponding to the drift distance. Defaults to 1.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A dictionary of fitting parameters including the following,</p>
<ul class="simple">
<li><p>”coeffs”: Fitted function coefficients.</p></li>
<li><p>”axis”: Fitted energy axis.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.energy.poly_energy_calibration">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.energy.</span></span><span class="sig-name descname"><span class="pre">poly_energy_calibration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lstsq'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kinetic'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#poly_energy_calibration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.poly_energy_calibration" title="Link to this definition">#</a></dt>
<dd><p>Energy calibration by nonlinear least squares fitting of spectral landmarks on
a set of (energy dispersion curves (EDCs). This amounts to solving for the
coefficient vector, a, in the system of equations T.a = b. Here T is the
differential drift time matrix and b the differential bias vector, and
assuming that the energy-drift-time relationship can be written in the form,
E = sum_n (a_n * t**n) + E0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>np.ndarray</em>) – Positions of the spectral landmarks
(e.g. peaks) in the EDCs.</p></li>
<li><p><strong>vals</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>np.ndarray</em>) – Bias voltage value associated with
each EDC.</p></li>
<li><p><strong>ref_energy</strong> (<em>float</em>) – Energy value of the feature in the reference
trace (eV).</p></li>
<li><p><strong>order</strong> (<em>int</em><em>, </em><em>optional</em>) – Polynomial order of the fitting function. Defaults to 3.</p></li>
<li><p><strong>t</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>np.ndarray</em><em>, </em><em>optional</em>) – Array of TOF values. Required
to calculate calibration trace. Defaults to None.</p></li>
<li><p><strong>aug</strong> (<em>int</em><em>, </em><em>optional</em>) – Fitting dimension augmentation
(1=no change, 2=double, etc). Defaults to 1.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Method for determining the energy calibration.</p>
<ul>
<li><p><strong>’lstsq’</strong>: Use <code class="docutils literal notranslate"><span class="pre">numpy.linalg.lstsq</span></code>.</p></li>
<li><p><strong>’lsqr’</strong>: Use <code class="docutils literal notranslate"><span class="pre">scipy.sparse.linalg.lsqr</span></code></p></li>
</ul>
<p>Defaults to “lstsq”.</p>
</p></li>
<li><p><strong>energy_scale</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Direction of increasing energy scale.</p>
<ul>
<li><p><strong>’kinetic’</strong>: increasing energy with decreasing TOF.</p></li>
<li><p><strong>’binding’</strong>: increasing energy with increasing TOF.</p></li>
</ul>
</p></li>
<li><p><strong>**kwds</strong> – Keyword arguments passed to <code class="docutils literal notranslate"><span class="pre">lstsq</span></code> or <code class="docutils literal notranslate"><span class="pre">lsqr</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A dictionary of fitting parameters including the following,</p>
<ul class="simple">
<li><p>”coeffs”: Fitted polynomial coefficients (the a’s).</p></li>
<li><p>”offset”: Minimum time-of-flight corresponding to a peak.</p></li>
<li><p>”Tmat”: the T matrix (differential time-of-flight) in the equation Ta=b.</p></li>
<li><p>”bvec”: the b vector (differential bias) in the fitting Ta=b.</p></li>
<li><p>”axis”: Fitted energy axis.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.energy.tof2ev">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.energy.</span></span><span class="sig-name descname"><span class="pre">tof2ev</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tof_distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binwidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binning</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#tof2ev"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.tof2ev" title="Link to this definition">#</a></dt>
<dd><p>(d/(t-t0))**2 expression of the time-of-flight to electron volt
conversion formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tof_distance</strong> (<em>float</em>) – Drift distance in meter.</p></li>
<li><p><strong>time_offset</strong> (<em>float</em>) – time offset in ns.</p></li>
<li><p><strong>binwidth</strong> (<em>float</em>) – Time width of each original TOF bin in ns.</p></li>
<li><p><strong>binning</strong> (<em>int</em>) – Binning factor of the TOF values.</p></li>
<li><p><strong>energy_scale</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Direction of increasing energy scale.</p>
<ul>
<li><p><strong>’kinetic’</strong>: increasing energy with decreasing TOF.</p></li>
<li><p><strong>’binding’</strong>: increasing energy with increasing TOF.</p></li>
</ul>
</p></li>
<li><p><strong>energy_offset</strong> (<em>float</em>) – Energy offset in eV.</p></li>
<li><p><strong>t</strong> (<em>float</em>) – TOF value in bin number.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted energy in eV</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.energy.tof2evpoly">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.energy.</span></span><span class="sig-name descname"><span class="pre">tof2evpoly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#tof2evpoly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.tof2evpoly" title="Link to this definition">#</a></dt>
<dd><p>Polynomial approximation of the time-of-flight to electron volt
conversion formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>poly_a</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>np.ndarray</em>) – Polynomial coefficients.</p></li>
<li><p><strong>energy_offset</strong> (<em>float</em>) – Energy offset in eV.</p></li>
<li><p><strong>t</strong> (<em>float</em>) – TOF value in bin number.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.energy.tof2ns">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.energy.</span></span><span class="sig-name descname"><span class="pre">tof2ns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binwidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binning</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/energy.html#tof2ns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.energy.tof2ns" title="Link to this definition">#</a></dt>
<dd><p>Converts the time-of-flight steps to time-of-flight in nanoseconds.</p>
<p>designed for use with dask.dataframe.DataFrame.map_partitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>binwidth</strong> (<em>float</em>) – Time step size in seconds.</p></li>
<li><p><strong>binning</strong> (<em>int</em>) – Binning of the time-of-flight steps.</p></li>
<li><p><strong>t</strong> (<em>float</em>) – TOF value in bin number.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted time in nanoseconds.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-sed.calibrator.delay">
<span id="delay-calibration-and-correction"></span><h2>Delay calibration and correction<a class="headerlink" href="#module-sed.calibrator.delay" title="Link to this heading">#</a></h2>
<p>sed.calibrator.delay module. Code for delay calibration.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sed.calibrator.delay.DelayCalibrator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sed.calibrator.delay.</span></span><span class="sig-name descname"><span class="pre">DelayCalibrator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/delay.html#DelayCalibrator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.delay.DelayCalibrator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Pump-Probe delay calibration methods.
Initialization of the DelayCalibrator class passes the config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>dict</em><em>, </em><em>optional</em>) – Config dictionary. Defaults to None.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to print out diagnostic information.
Defaults to True.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="sed.calibrator.delay.DelayCalibrator.verbose">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">verbose</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#sed.calibrator.delay.DelayCalibrator.verbose" title="Link to this definition">#</a></dt>
<dd><p>Accessor to the verbosity flag.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Verbosity flag.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.delay.DelayCalibrator.append_delay_axis">
<span class="sig-name descname"><span class="pre">append_delay_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adc_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adc_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_range_mm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datafile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/delay.html#DelayCalibrator.append_delay_axis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.delay.DelayCalibrator.append_delay_axis" title="Link to this definition">#</a></dt>
<dd><p>Calculate and append the delay axis to the events dataframe, by converting
values from an analog-digital-converter (ADC).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em> | </em><em>dask.dataframe.DataFrame</em>) – The dataframe where
to apply the delay calibration to.</p></li>
<li><p><strong>adc_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Source column for delay calibration.
Defaults to config[“dataframe”][“columns”][“adc”].</p></li>
<li><p><strong>delay_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Destination column for delay calibration.
Defaults to config[“dataframe”][“columns”][“delay”].</p></li>
<li><p><strong>calibration</strong> (<em>dict</em><em>, </em><em>optional</em>) – Calibration dictionary with parameters for
delay calibration.</p></li>
<li><p><strong>adc_range</strong> (<em>tuple</em><em> | </em><em>list</em><em> | </em><em>np.ndarray</em><em>, </em><em>optional</em>) – The range of used
ADC values. Defaults to config[“delay”][“adc_range”].</p></li>
<li><p><strong>delay_range</strong> (<em>tuple</em><em> | </em><em>list</em><em> | </em><em>np.ndarray</em><em>, </em><em>optional</em>) – Range of scanned
delay values in ps. If omitted, the range is calculated from the
delay_range_mm and t0 values.</p></li>
<li><p><strong>time0</strong> (<em>float</em><em>, </em><em>optional</em>) – Pump-Probe overlap value of the delay coordinate.
If omitted, it is searched for in the data files.</p></li>
<li><p><strong>delay_range_mm</strong> (<em>tuple</em><em> | </em><em>list</em><em> | </em><em>np.ndarray</em><em>, </em><em>optional</em>) – Range of scanned
delay stage in mm. If omitted, it is searched for in the data files.</p></li>
<li><p><strong>datafile</strong> (<em>str</em><em>, </em><em>optional</em>) – Datafile in which delay parameters are searched
for. Defaults to None.</p></li>
<li><p><strong>p1_key</strong> (<em>str</em><em>, </em><em>optional</em>) – hdf5 key for delay_range_mm start value.
Defaults to config[“delay”][“p1_key”]</p></li>
<li><p><strong>p2_key</strong> (<em>str</em><em>, </em><em>optional</em>) – hdf5 key for delay_range_mm end value.
Defaults to config[“delay”][“p2_key”]</p></li>
<li><p><strong>t0_key</strong> (<em>str</em><em>, </em><em>optional</em>) – hdf5 key for t0 value (mm).
Defaults to config[“delay”][“t0_key”]</p></li>
<li><p><strong>suppress_output</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to suppress log output. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Raised if delay parameters are not found in the file.</p></li>
<li><p><strong>NotImplementedError</strong> – Raised if no sufficient information passed.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dataframe with added column
and delay calibration metadata dictionary.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[pd.DataFrame | dask.dataframe.DataFrame, dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sed.calibrator.delay.DelayCalibrator.add_offsets">
<span class="sig-name descname"><span class="pre">add_offsets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_delay_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preserve_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reductions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/delay.html#DelayCalibrator.add_offsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.delay.DelayCalibrator.add_offsets" title="Link to this definition">#</a></dt>
<dd><p>Apply an offset to the delay column based on a constant or other columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>Union</em><em>[</em><em>pd.DataFrame</em><em>, </em><em>dask.dataframe.DataFrame</em><em>]</em>) – Dataframe to use.</p></li>
<li><p><strong>offsets</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of delay offset parameters.</p></li>
<li><p><strong>constant</strong> (<em>float</em><em>, </em><em>optional</em>) – The constant to shift the delay axis by.</p></li>
<li><p><strong>flip_delay_axis</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to flip the time axis. Defaults to False.</p></li>
<li><p><strong>columns</strong> (<em>str</em><em> | </em><em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Name of the column(s) to apply the shift from.</p></li>
<li><p><strong>weights</strong> (<em>float</em><em> | </em><em>Sequence</em><em>[</em><em>float</em><em>]</em>) – weights to apply to the columns.
Can also be used to flip the sign (e.g. -1). Defaults to 1.</p></li>
<li><p><strong>preserve_mean</strong> (<em>bool</em><em> | </em><em>Sequence</em><em>[</em><em>bool</em><em>]</em>) – Whether to subtract the mean of the column
before applying the shift. Defaults to False.</p></li>
<li><p><strong>reductions</strong> (<em>str</em><em> | </em><em>Sequence</em><em>[</em><em>str</em><em>]</em>) – The reduction to apply to the column. Should be an
available method of dask.dataframe.Series. For example “mean”. In this case the
function is applied to the column to generate a single value for the whole dataset.
If None, the shift is applied per-dataframe-row. Defaults to None. Currently only
“mean” is supported.</p></li>
<li><p><strong>delay_column</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the column containing the delay values.</p></li>
<li><p><strong>suppress_output</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to suppress log output. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with the shifted delay axis and
Metadata dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[dask.dataframe.DataFrame, dict]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.delay.extract_delay_stage_parameters">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.delay.</span></span><span class="sig-name descname"><span class="pre">extract_delay_stage_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/delay.html#extract_delay_stage_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.delay.extract_delay_stage_parameters" title="Link to this definition">#</a></dt>
<dd><p>Read delay stage ranges from hdf5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – filename</p></li>
<li><p><strong>p1_key</strong> (<em>str</em>) – hdf5 path to the start of the scan range</p></li>
<li><p><strong>p2_key</strong> (<em>str</em>) – hdf5 path to the end of the scan range</p></li>
<li><p><strong>t0_key</strong> (<em>str</em>) – hdf5 path to the t0 value</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(p1_value, p2_value, t0_value)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sed.calibrator.delay.mm_to_ps">
<span class="sig-prename descclassname"><span class="pre">sed.calibrator.delay.</span></span><span class="sig-name descname"><span class="pre">mm_to_ps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delay_mm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time0_mm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sed/calibrator/delay.html#mm_to_ps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sed.calibrator.delay.mm_to_ps" title="Link to this definition">#</a></dt>
<dd><p>Converts a delay stage position in mm into a relative delay in picoseconds
(double pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delay_mm</strong> (<em>float</em><em> | </em><em>np.ndarray</em>) – Delay stage position in mm</p></li>
<li><p><strong>time0_mm</strong> (<em>float</em>) – Delay stage position of pump-probe overlap in mm</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Relative delay in picoseconds</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float | np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="binning.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Binning</p>
      </div>
    </a>
    <a class="right-next"
       href="dataset.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Dataset</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-sed.calibrator.momentum">Momentum calibration and correction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.verbose"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.verbose</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.features"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.features</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.symscores"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.symscores</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.load_data"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.load_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.select_slicer"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.select_slicer()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.select_slice"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.select_slice()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.add_features"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.add_features()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.feature_extract"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.feature_extract()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.feature_select"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.feature_select()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.calc_geometric_distances"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.calc_geometric_distances()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.calc_symmetry_scores"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.calc_symmetry_scores()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.spline_warp_estimate"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.spline_warp_estimate()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.apply_correction"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.apply_correction()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.reset_deformation"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.reset_deformation()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.update_deformation"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.update_deformation()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.coordinate_transform"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.coordinate_transform()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.pose_adjustment"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.pose_adjustment()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.calc_inverse_dfield"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.calc_inverse_dfield()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.view"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.view()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.select_k_range"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.select_k_range()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.calibrate"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.calibrate()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.apply_corrections"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.apply_corrections()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.gather_correction_metadata"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.gather_correction_metadata()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.append_k_axis"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.append_k_axis()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.MomentumCorrector.gather_calibration_metadata"><code class="docutils literal notranslate"><span class="pre">MomentumCorrector.gather_calibration_metadata()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.cm2palette"><code class="docutils literal notranslate"><span class="pre">cm2palette()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.dictmerge"><code class="docutils literal notranslate"><span class="pre">dictmerge()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.detector_coordinates_2_k_coordinates"><code class="docutils literal notranslate"><span class="pre">detector_coordinates_2_k_coordinates()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.apply_dfield"><code class="docutils literal notranslate"><span class="pre">apply_dfield()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.generate_inverse_dfield"><code class="docutils literal notranslate"><span class="pre">generate_inverse_dfield()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.momentum.load_dfield"><code class="docutils literal notranslate"><span class="pre">load_dfield()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-sed.calibrator.energy">Energy calibration and correction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.verbose"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.verbose</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.ntraces"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.ntraces</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.nranges"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.nranges</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.dup"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.dup</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.load_data"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.load_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.bin_data"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.bin_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.normalize"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.normalize()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.adjust_ranges"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.adjust_ranges()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.add_ranges"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.add_ranges()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.feature_extract"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.feature_extract()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.calibrate"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.calibrate()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.view"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.view()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.append_energy_axis"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.append_energy_axis()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.append_tof_ns_axis"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.append_tof_ns_axis()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.gather_calibration_metadata"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.gather_calibration_metadata()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.adjust_energy_correction"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.adjust_energy_correction()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.apply_energy_correction"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.apply_energy_correction()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.gather_correction_metadata"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.gather_correction_metadata()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.align_dld_sectors"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.align_dld_sectors()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.EnergyCalibrator.add_offsets"><code class="docutils literal notranslate"><span class="pre">EnergyCalibrator.add_offsets()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.extract_bias"><code class="docutils literal notranslate"><span class="pre">extract_bias()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.correction_function"><code class="docutils literal notranslate"><span class="pre">correction_function()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.normspec"><code class="docutils literal notranslate"><span class="pre">normspec()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.find_correspondence"><code class="docutils literal notranslate"><span class="pre">find_correspondence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.range_convert"><code class="docutils literal notranslate"><span class="pre">range_convert()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.find_nearest"><code class="docutils literal notranslate"><span class="pre">find_nearest()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.peaksearch"><code class="docutils literal notranslate"><span class="pre">peaksearch()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.peakdetect1d"><code class="docutils literal notranslate"><span class="pre">peakdetect1d()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.fit_energy_calibration"><code class="docutils literal notranslate"><span class="pre">fit_energy_calibration()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.poly_energy_calibration"><code class="docutils literal notranslate"><span class="pre">poly_energy_calibration()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.tof2ev"><code class="docutils literal notranslate"><span class="pre">tof2ev()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.tof2evpoly"><code class="docutils literal notranslate"><span class="pre">tof2evpoly()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.energy.tof2ns"><code class="docutils literal notranslate"><span class="pre">tof2ns()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-sed.calibrator.delay">Delay calibration and correction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.delay.DelayCalibrator"><code class="docutils literal notranslate"><span class="pre">DelayCalibrator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.delay.DelayCalibrator.verbose"><code class="docutils literal notranslate"><span class="pre">DelayCalibrator.verbose</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.delay.DelayCalibrator.append_delay_axis"><code class="docutils literal notranslate"><span class="pre">DelayCalibrator.append_delay_axis()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.delay.DelayCalibrator.add_offsets"><code class="docutils literal notranslate"><span class="pre">DelayCalibrator.add_offsets()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.delay.extract_delay_stage_parameters"><code class="docutils literal notranslate"><span class="pre">extract_delay_stage_parameters()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sed.calibrator.delay.mm_to_ps"><code class="docutils literal notranslate"><span class="pre">mm_to_ps()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/sed/calibrator.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, OpenCOMPES team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>